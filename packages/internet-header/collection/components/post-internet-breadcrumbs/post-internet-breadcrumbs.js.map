{"version":3,"file":"post-internet-breadcrumbs.js","sourceRoot":"","sources":["../../../../src/components/post-internet-breadcrumbs/post-internet-breadcrumbs.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, Host, h, Prop, State, Element, Watch } from '@stencil/core';\r\nimport { debounce } from 'throttle-debounce';\r\nimport { disableBodyScroll, enableBodyScroll, clearAllBodyScrollLocks } from 'body-scroll-lock';\r\nimport { SvgIcon } from '../../utils/svg-icon.component';\r\nimport { state } from '../../data/store';\r\nimport { OverlayComponent } from './components/overlay.component';\r\nimport { iframeResizer } from 'iframe-resizer';\r\nimport { IBreadcrumbOverlay, IBreadcrumbItem } from '../../models/breadcrumbs.model';\r\nimport { SvgSprite } from '../../utils/svg-sprite.component';\r\nimport { BreadcrumbList } from './components/breadcrumb-list.component';\r\nimport { prefersReducedMotion } from '../../utils/utils';\r\n\r\n@Component({\r\n  tag: 'swisspost-internet-breadcrumbs',\r\n  styleUrl: 'post-internet-breadcrumbs.scss',\r\n  shadow: true,\r\n})\r\nexport class PostInternetBreadcrumbs {\r\n  @Prop() customItems?: string | IBreadcrumbItem[];\r\n  @State() customBreadcrumbItems?: IBreadcrumbItem[];\r\n  @State() overlayVisible: boolean;\r\n  @State() isConcatenated: boolean; // Don't set an initial value, this has to be calculated first, otherwise reactivity problems ensue\r\n  @State() dropdownOpen: boolean = false;\r\n  @State() refsReady: boolean = false;\r\n  @Element() host: Element;\r\n\r\n  private controlNavRef?: HTMLElement;\r\n  private visibleNavRef?: HTMLElement;\r\n  private currentOverlay: IBreadcrumbOverlay;\r\n  private debouncedResize: debounce<() => void>;\r\n  private lastWindowWidth: number;\r\n  private openAnimation: Animation;\r\n  private loadedAnimation: Animation | undefined;\r\n\r\n  connectedCallback() {\r\n    this.debouncedResize = debounce(200, this.handleResize.bind(this));\r\n    window.addEventListener('resize', this.debouncedResize, { passive: true });\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    window.removeEventListener('resize', this.debouncedResize);\r\n    window.removeEventListener('click', this.handleWindowClick);\r\n    clearAllBodyScrollLocks();\r\n  }\r\n\r\n  async componentWillLoad() {\r\n    // Wait for the config to arrive, then render the header\r\n    try {\r\n      this.customBreadcrumbItems =\r\n        typeof this.customItems === 'string' ? JSON.parse(this.customItems) : this.customItems;\r\n    } catch (error) {\r\n      console.error(error);\r\n    }\r\n  }\r\n\r\n  componentDidLoad() {\r\n    // Initially check if breadcrumb items are concatenated\r\n    window.requestAnimationFrame(() => {\r\n      this.handleResize();\r\n    });\r\n  }\r\n\r\n  @Watch('customItems')\r\n  handleCustomConfigChage(newValue: string | IBreadcrumbItem[]) {\r\n    try {\r\n      this.customBreadcrumbItems = typeof newValue === 'string' ? JSON.parse(newValue) : newValue;\r\n    } catch (error) {\r\n      console.error(error);\r\n    }\r\n  }\r\n\r\n  handleResize() {\r\n    // Catch and exclude vertical resize events, e.g. scrolling in iPhone\r\n    if (window.innerWidth === this.lastWindowWidth) {\r\n      return;\r\n    }\r\n    this.lastWindowWidth = window.innerWidth;\r\n    this.checkConcatenation();\r\n  }\r\n\r\n  checkConcatenation() {\r\n    if (this.controlNavRef && this.visibleNavRef) {\r\n      this.refsReady = true;\r\n\r\n      // Delay the check\r\n      window.requestAnimationFrame(() => {\r\n        if (this.controlNavRef && this.visibleNavRef) {\r\n          this.isConcatenated = this.controlNavRef.clientWidth > this.visibleNavRef.clientWidth;\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  toggleOverlay(overlay: IBreadcrumbOverlay, force?: boolean) {\r\n    const newVisibility = force ?? !this.overlayVisible;\r\n\r\n    if (newVisibility) {\r\n      // Will trigger overlayRef() once the HTLM is rendered\r\n      this.overlayVisible = newVisibility;\r\n      this.currentOverlay = overlay;\r\n      this.setBodyScroll(overlay);\r\n    } else {\r\n      const activeToggler = this.host.shadowRoot?.querySelector<HTMLElement>(\r\n        '.breadcrumb-buttons [aria-expanded=\"true\"]',\r\n      );\r\n\r\n      if (this.openAnimation && this.loadedAnimation) {\r\n        this.openAnimation.reverse();\r\n        this.loadedAnimation.reverse();\r\n\r\n        // Delay hiding overlay until after the animation finishes\r\n        Promise.all([this.openAnimation.finished, this.loadedAnimation.finished]).then(() => {\r\n          if (activeToggler) {\r\n            activeToggler.focus();\r\n          }\r\n          this.overlayVisible = newVisibility;\r\n          this.setBodyScroll(overlay);\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Disable or re-enable body scrolling, depending on whether overlay is visible or not\r\n   */\r\n  setBodyScroll(overlay: IBreadcrumbOverlay) {\r\n    if (this.overlayVisible) {\r\n      disableBodyScroll(overlay, { reserveScrollBarGap: true });\r\n    } else {\r\n      enableBodyScroll(overlay);\r\n    }\r\n  }\r\n\r\n  toggleDropdown(force?: boolean) {\r\n    this.dropdownOpen = force ?? !this.dropdownOpen;\r\n\r\n    if (this.dropdownOpen) {\r\n      requestAnimationFrame(() => {\r\n        document.addEventListener('click', this.handleWindowClick.bind(this), { once: true });\r\n      });\r\n    }\r\n  }\r\n\r\n  handleWindowClick() {\r\n    this.toggleDropdown(false);\r\n  }\r\n\r\n  registerIFrameResizer(iFrame: HTMLIFrameElement) {\r\n    if (!iFrame) {\r\n      return;\r\n    }\r\n\r\n    iFrame.addEventListener('load', () => {\r\n      iframeResizer(\r\n        {\r\n          heightCalculationMethod: 'taggedElement',\r\n          scrolling: true,\r\n          checkOrigin: false,\r\n        },\r\n        iFrame,\r\n      );\r\n      const duration = prefersReducedMotion ? 0 : 300;\r\n      this.loadedAnimation = iFrame.parentElement?.animate(\r\n        [{ opacity: 1, visibility: 'visible', transform: 'translateY(0px)' }],\r\n        { duration, fill: 'forwards' },\r\n      );\r\n      iFrame.parentElement?.classList.add('loaded');\r\n      this.loadedAnimation?.finished.then(() => {\r\n        iFrame.parentElement?.focus();\r\n      });\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Reference function for the overlay element got called. It is either null (overlay closed)\r\n   * or contains the overlay element as parameter.\r\n   * @param e Overlay element or null\r\n   * @returns void\r\n   */\r\n  overlayRef(e: HTMLElement | undefined) {\r\n    if (!e) {\r\n      return;\r\n    }\r\n\r\n    const duration = prefersReducedMotion ? 0 : 500;\r\n    this.openAnimation = e.animate([{ opacity: 1, visibility: 'visible' }], {\r\n      duration,\r\n      fill: 'forwards',\r\n    });\r\n  }\r\n\r\n  private handleKeyDown(event: KeyboardEvent) {\r\n    if (event.key.toLowerCase() === 'escape') {\r\n      this.toggleOverlay(this.currentOverlay, false);\r\n    }\r\n  }\r\n\r\n  private handleToggleDropdown() {\r\n    this.toggleDropdown();\r\n  }\r\n\r\n  private handleToggleOverlay() {\r\n    this.toggleOverlay(this.currentOverlay, false);\r\n  }\r\n\r\n  private handleControlNavRef(element: HTMLElement) {\r\n    this.controlNavRef = element;\r\n    this.checkConcatenation();\r\n  }\r\n\r\n  private handleVisibleNavRef(element: HTMLElement) {\r\n    this.visibleNavRef = element;\r\n    this.checkConcatenation();\r\n  }\r\n\r\n  render() {\r\n    // There is something wrong entirely\r\n    if (!state) {\r\n      console.warn(\r\n        `Internet Breadcrumbs: Could not load config. Please make sure that you included the <swisspost-internet-header></swisspost-internet-header> component.`,\r\n      );\r\n      return null;\r\n    }\r\n\r\n    // Config is not loaded yet\r\n    if (!state.localizedConfig) {\r\n      return null;\r\n    }\r\n\r\n    // Config has loaded but there is no breadcrumbs config\r\n    if (!state.localizedConfig.breadcrumb) {\r\n      console.warn(\r\n        `Internet Header: Current project \"${state.projectId}\" does not include a breadcrumb config. The breadcrumbs will not be rendered. Remove `,\r\n        document.querySelector('swisspost-internet-breadcrumbs'),\r\n        `from your markup or configure the breadcrumbs in your portal config to stop seeing this warning.`,\r\n      );\r\n      return null;\r\n    }\r\n\r\n    const breadcrumbConfig = state.localizedConfig.breadcrumb;\r\n    const items =\r\n      this.customBreadcrumbItems !== undefined\r\n        ? [...breadcrumbConfig.items, ...this.customBreadcrumbItems]\r\n        : breadcrumbConfig.items;\r\n\r\n    return (\r\n      <Host>\r\n        <SvgSprite />\r\n        <div class=\"breadcrumbs\">\r\n          <div class=\"hidden-control-breadcrumbs\" aria-hidden=\"true\" tabindex=\"-1\">\r\n            <nav class=\"breadcrumbs-nav\" ref={e => e !== undefined && this.handleControlNavRef(e)}>\r\n              <BreadcrumbList\r\n                items={items}\r\n                focusable={false}\r\n                clickHandler={() => {}}\r\n              ></BreadcrumbList>\r\n            </nav>\r\n          </div>\r\n          <h2 class=\"visually-hidden\">{breadcrumbConfig.a11yLabel}</h2>\r\n          <nav\r\n            ref={e => e !== undefined && this.handleVisibleNavRef(e)}\r\n            class={{\r\n              'breadcrumbs-nav': true,\r\n              'visually-hidden': !this.refsReady,\r\n            }}\r\n          >\r\n            <BreadcrumbList\r\n              items={items}\r\n              dropdownOpen={this.dropdownOpen}\r\n              isConcatenated={this.isConcatenated}\r\n              clickHandler={() => this.handleToggleDropdown()}\r\n            ></BreadcrumbList>\r\n          </nav>\r\n          <div class=\"breadcrumb-buttons\">\r\n            {breadcrumbConfig.buttons.map(button => (\r\n              <button\r\n                class=\"btn btn-secondary btn-icon\"\r\n                key={button.text}\r\n                aria-expanded={`${!!this.overlayVisible && this.currentOverlay === button.overlay}`}\r\n                onClick={() => this.toggleOverlay(button.overlay, true)}\r\n              >\r\n                <SvgIcon name={button.svgIcon.name}></SvgIcon>\r\n                <span class=\"visually-hidden\">{button.text}</span>\r\n              </button>\r\n            ))}\r\n          </div>\r\n          {this.overlayVisible && (\r\n            <OverlayComponent\r\n              overlayRef={e => e !== undefined && this.overlayRef(e)}\r\n              iFrameRef={e => e !== undefined && this.registerIFrameResizer(e)}\r\n              overlay={this.currentOverlay}\r\n              onClick={() => this.handleToggleOverlay()}\r\n              onKeyDown={(e: KeyboardEvent) => this.handleKeyDown(e)}\r\n              closeButtonText={state.localizedConfig.header.translations.closeButtonText}\r\n            ></OverlayComponent>\r\n          )}\r\n        </div>\r\n        <slot></slot>\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"]}