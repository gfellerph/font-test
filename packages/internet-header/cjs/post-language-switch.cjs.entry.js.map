{"file":"post-language-switch.entry.cjs.js","mappings":";;;;;;;;;;;AAIO,MAAM,sBAAsB,GAAG,CAAC,KAItC,MACCA,iBAAK,KAAK,EAAC,0BAA0B,EAAC,GAAG,EAAE,CAAC,IAAI,KAAK,CAAC,WAAW,CAAC,CAAC,CAAC;EAClEA,gBAAI,KAAK,EAAC,iBAAiB,IAAEC,0BAAS,CAAC,iBAAiB,CAAC,CAAM;EAC/DD,oBACG,KAAK,CAAC,OAAO;KACX,MAAM,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC;KAC/B,GAAG,CAAC,IAAI;IACP,MAAM,OAAO,GAAG,IAAI,CAAC,GAAG,KAAK,IAAI,GAAG,QAAQ,GAAG,GAAG,CAAC;IACnD,QACEA,gBAAI,GAAG,EAAE,IAAI,CAAC,IAAI;MAChBA,QAAC,OAAO,IACN,OAAO,EAAE,MAAM,KAAK,CAAC,cAAc,CAAC,IAAI,CAAC,EACzC,IAAI,EAAE,IAAI,CAAC,GAAG,EACd,IAAI,EAAE,IAAI,CAAC,IAAI,EACf,KAAK,EAAE,IAAI,CAAC,KAAK;QAEjBA,kBAAM,KAAK,EAAC,iBAAiB,IAAE,IAAI,CAAC,KAAK,CAAQ;QACjDA,iCAAkB,MAAM,IAAE,IAAI,CAAC,IAAI,CAAQ,CACnC,CACP,EACL;GACH,CAAC,CACD,CACD,CACP;;AChCD,MAAM,qBAAqB,GAAG,kqKAAkqK;;MC8BnrK,kBAAkB;;;;;;0BAEH,KAAK;;EAM/B,mBAAmB;;IAEjB,IAAI,IAAI,CAAC,sBAAsB,IAAI,CAAC,IAAI,CAAC,cAAc,IAAI,IAAI,CAAC,IAAI,IAAI,UAAU,EAAE;MAClF,IAAI,CAAC,sBAAsB,CAAC,SAAS,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;;MAGrD,IACEE,+BAAoB,CAAC,IAAI,CAAC,sBAAsB,EAAE,WAAW,CAAC;QAC9D,CAACC,mCAAwB,EAAE,EAC3B;;QAEA,OAAO,IAAI,OAAO,CAAU,OAAO;;UACjC,MAAA,IAAI,CAAC,sBAAsB,0CAAE,gBAAgB,CAAC,eAAe,EAAE,KAAK;YAClE,IAAI,KAAK,CAAC,YAAY,KAAK,WAAW,EAAE;cACtC,OAAO,CAAC,IAAI,CAAC,CAAC;aACf;WACF,CAAC,CAAC;SACJ,CAAC,CAAC;OACJ;KACF;GACF;EAED,kBAAkB;;IAEhB,IAAI,IAAI,CAAC,sBAAsB,IAAI,IAAI,CAAC,cAAc,EAAE;;MAEtD,IAAI,CAAC,sBAAsB,CAAC,qBAAqB,EAAE,CAAC;MACpD,IAAI,CAAC,sBAAsB,CAAC,SAAS,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;KACnD;GACF;;;;;;EAQD,MAAM,cAAc,CAAC,KAAe;IAClC,IAAI,CAAC,cAAc,GAAG,KAAK,aAAL,KAAK,cAAL,KAAK,GAAI,CAAC,IAAI,CAAC,cAAc,CAAC;IACpD,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,IAAI,CAAC,cAAc,EAAE,OAAO,EAAE,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC;IAC7E,OAAO,IAAI,CAAC,cAAc,CAAC;GAC5B;;;;;;EAOD,cAAc,CAAC,OAAsB;IACnC,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;IACxC,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC;GAC5B;EAEO,uBAAuB,CAAC,MAAuB,EAAE,SAAgC;IACvF,IAAI,SAAS,KAAK,SAAS,EAAE;MAC3B,OAAO,MAAM,CAAC;KACf;IAED,OAAO,MAAM,CAAC,GAAG,CAAC,UAAU,IAC1B,MAAM,CAAC,MAAM,CACX,EAAE,EACF,UAAU,EACV,SAAS,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,KAAK,UAAU,CAAC,IAAI,CAAC,CAChD,CACF,CAAC;GACH;EAEO,cAAc,CAAC,OAAgC;IACrD,IAAI,CAAC,sBAAsB,GAAG,OAAO,CAAC;GACvC;EAED,MAAM;;IACJ,IAAI,CAAA,MAAAC,WAAK,CAAC,eAAe,0CAAE,MAAM,MAAK,SAAS;MAAE,OAAO;IACxD,MAAM,MAAM,GAAGA,WAAK,CAAC,eAAe,CAAC,MAAM,CAAC;IAC5C,MAAM,YAAY,GAAG,IAAI,CAAC,uBAAuB,CAC/C,MAAM,CAAC,OAAO,EACdA,WAAK,CAAC,uBAAuB,CAC9B,CAAC;IAEF,QACEJ,QAACK,UAAI,QACHL,iBAAK,KAAK,EAAE,mBAAmB,IAAI,CAAC,IAAI,EAAE,IACxCA,QAACM,6BAAS,OAAG,EACZ,IAAI,CAAC,IAAI,KAAK,UAAU,IACvBN,oBACE,KAAK,EAAC,UAAU,mBACD,GAAG,IAAI,CAAC,cAAc,EAAE,mBACzB,SAAS,EACvB,OAAO,EAAE,MAAM,IAAI,CAAC,cAAc,EAAE,IAEpCA,kBAAM,KAAK,EAAC,iBAAiB,IAAE,MAAM,CAAC,YAAY,CAAC,gBAAgB,CAAQ,EAC3EA,iCAAkB,MAAM,IAAEI,WAAK,CAAC,eAAe,CAAQ,EACvDJ,QAACO,yBAAO,IAAC,IAAI,EAAC,eAAe,EAAC,UAAU,EAAE,IAAI,CAAC,cAAc,GAAG,SAAS,GAAG,EAAE,GAAI,CAC3E,KAETP,kBAAM,KAAK,EAAC,uBAAuB,IACjCA,kBAAM,KAAK,EAAC,iBAAiB,IAAEC,0BAAS,CAAC,6BAA6B,CAAC,CAAQ,EAC/ED,sBAAOI,WAAK,CAAC,eAAe,CAAQ,CAC/B,CACR,EACA,IAAI,CAAC,cAAc,IAAI,IAAI,CAAC,IAAI,KAAK,MAAM,IAC1CJ,QAAC,sBAAsB,IACrB,OAAO,EAAE,YAAY,EACrB,cAAc,EAAE,CAAC,IAAI,IAAI,CAAC,cAAc,CAAC,CAAC,CAAC,EAC3C,WAAW,EAAE,CAAC,IAAI,CAAC,KAAK,SAAS,IAAI,IAAI,CAAC,cAAc,CAAC,CAAC,CAAC,GAC3D,IACA,IAAI,CACJ,CACD,EACP;GACH;;;;;;;","names":["h","translate","elementHasTransition","userPrefersReducedMotion","state","Host","SvgSprite","SvgIcon"],"sources":["./src/components/post-language-switch/components/post-language-switch-list.tsx","./src/components/post-language-switch/post-language-switch.scss?tag=post-language-switch&encapsulation=shadow","./src/components/post-language-switch/post-language-switch.tsx"],"sourcesContent":["import { h } from '@stencil/core';\r\nimport { NavLangEntity } from '../../../models/header.model';\r\nimport { translate } from '../../../services/language.service';\r\n\r\nexport const PostLanguageSwitchList = (props: {\r\n  navLang: NavLangEntity[];\r\n  switchLanguage: (lang: NavLangEntity) => void;\r\n  dropdownRef: (element: HTMLElement | undefined) => void;\r\n}) => (\r\n  <nav class=\"language-switch-dropdown\" ref={e => props.dropdownRef(e)}>\r\n    <h3 class=\"visually-hidden\">{translate('Change language')}</h3>\r\n    <ul>\r\n      {props.navLang\r\n        .filter(lang => !lang.isCurrent)\r\n        .map(lang => {\r\n          const TagName = lang.url === null ? 'button' : 'a';\r\n          return (\r\n            <li key={lang.lang}>\r\n              <TagName\r\n                onClick={() => props.switchLanguage(lang)}\r\n                href={lang.url}\r\n                lang={lang.lang}\r\n                title={lang.title}\r\n              >\r\n                <span class=\"visually-hidden\">{lang.title}</span>\r\n                <span aria-hidden=\"true\">{lang.text}</span>\r\n              </TagName>\r\n            </li>\r\n          );\r\n        })}\r\n    </ul>\r\n  </nav>\r\n);\r\n","@use \"@swisspost/design-system-styles/variables/color\";\r\n@use \"@swisspost/design-system-styles/functions\";\r\n@use \"../../utils/utils.scss\";\r\n\r\n:host {\r\n  --separator-display: none;\r\n  --separator-height: 100%;\r\n\r\n  display: flex;\r\n  align-items: center;\r\n  align-self: stretch;\r\n\r\n  &::before {\r\n    display: var(--separator-display);\r\n    height: var(--separator-height);\r\n    border-left: 1px solid color.$gray-10;\r\n    content: '';\r\n  }\r\n}\r\n\r\n.lang-btn {\r\n  display: flex;\r\n  align-items: center;\r\n  height: 100%;\r\n  padding: 0 1rem;\r\n  border: none;\r\n  box-shadow: none;\r\n  background: none;\r\n  text-transform: uppercase;\r\n  cursor: pointer;\r\n  color: rgba(color.$black, 0.8);\r\n\r\n  &:hover,\r\n  &:focus {\r\n    color: black;\r\n  }\r\n\r\n  svg {\r\n    width: 1.5em;\r\n    height: 1.5em;\r\n    transition: transform 250ms;\r\n\r\n    &.rotated {\r\n      transform: rotate(180deg);\r\n    }\r\n  }\r\n}\r\n\r\n.language-switch {\r\n  position: relative;\r\n  align-self: stretch;\r\n  height: 100%;\r\n\r\n  &.list {\r\n    margin-top: 1.5rem;\r\n    display: flex;\r\n    align-items: center;\r\n  }\r\n}\r\n\r\n.current-language {\r\n  text-transform: uppercase;\r\n  border-right: 1px solid color.$gray-20;\r\n  padding: 0.5rem 1rem 0.5rem 0;\r\n}\r\n\r\n.language-switch-dropdown {\r\n  .dropdown & {\r\n    position: absolute;\r\n    top: 100%;\r\n    width: 100%;\r\n    background: white;\r\n    box-shadow: 0 1px 2px rgb(0 0 0 / 20%), 0 2px 6px 2px rgb(0 0 0 / 10%);\r\n    z-index: 1;\r\n    transform: scale(0.1);\r\n    transform-origin: center top;\r\n    transition: transform 0.1s;\r\n    margin-top: var(--language-dropdown-margin-top);\r\n\r\n    @media (prefers-reduced-motion: reduce) {\r\n      transition: none;\r\n    }\r\n\r\n    &.open {\r\n      transform: scale(1);\r\n    }\r\n  }\r\n\r\n  ul {\r\n    @extend %no-list;\r\n\r\n    .list & {\r\n      display: flex;\r\n\r\n      > li + li {\r\n        border-left: 1px solid color.$gray-20;\r\n      }\r\n    }\r\n  }\r\n\r\n  a,\r\n  button {\r\n    @extend %nav-link;\r\n\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    width: 100%;\r\n    height: functions.px-to-rem(48px);\r\n    padding: 0 0.25rem;\r\n    text-transform: uppercase;\r\n    cursor: pointer;\r\n    transition: background-color 200ms, color 200ms;\r\n\r\n    &:hover,\r\n    &:focus {\r\n      background: color.$gray-background;\r\n    }\r\n\r\n    span {\r\n      // Worst case scenario\r\n      overflow: hidden;\r\n      white-space: nowrap;\r\n      text-overflow: ellipsis;\r\n    }\r\n\r\n    .list & {\r\n      color: black;\r\n      height: auto;\r\n      padding: 0.5rem 1rem;\r\n    }\r\n  }\r\n}\r\n","import {\r\n  Component,\r\n  Event,\r\n  Host,\r\n  h,\r\n  Method,\r\n  EventEmitter,\r\n  State,\r\n  Prop,\r\n  Element,\r\n} from '@stencil/core';\r\nimport { SvgSprite } from '../../utils/svg-sprite.component';\r\nimport { SvgIcon } from '../../utils/svg-icon.component';\r\nimport { state } from '../../data/store';\r\nimport {\r\n  DropdownElement,\r\n  DropdownEvent,\r\n  HasDropdown,\r\n  NavLangEntity,\r\n} from '../../models/header.model';\r\nimport { userPrefersReducedMotion, elementHasTransition } from '../../services/ui.service';\r\nimport { translate } from '../../services/language.service';\r\nimport { PostLanguageSwitchList } from './components/post-language-switch-list';\r\nimport { IAvailableLanguage } from '../../models/language.model';\r\n\r\n@Component({\r\n  tag: 'post-language-switch',\r\n  styleUrl: 'post-language-switch.scss',\r\n  shadow: true,\r\n})\r\nexport class PostLanguageSwitch implements HasDropdown {\r\n  @Prop() mode: 'dropdown' | 'list';\r\n  @State() langSwitchOpen = false;\r\n  @Element() host: DropdownElement;\r\n  @Event() dropdownToggled: EventEmitter<DropdownEvent>;\r\n  @Event({ bubbles: true }) languageChanged: EventEmitter<string>;\r\n  private languageSwitchDropdown: HTMLElement | undefined;\r\n\r\n  componentWillUpdate() {\r\n    // Check if language switch got set to close and if mode is dropdown\r\n    if (this.languageSwitchDropdown && !this.langSwitchOpen && this.mode == 'dropdown') {\r\n      this.languageSwitchDropdown.classList.remove('open');\r\n\r\n      // Check if element has transition applied and whether user prefers to see animations or not\r\n      if (\r\n        elementHasTransition(this.languageSwitchDropdown, 'transform') &&\r\n        !userPrefersReducedMotion()\r\n      ) {\r\n        // Wait for CSS transition 'transform' to end before continuing\r\n        return new Promise<boolean>(resolve => {\r\n          this.languageSwitchDropdown?.addEventListener('transitionend', event => {\r\n            if (event.propertyName === 'transform') {\r\n              resolve(true);\r\n            }\r\n          });\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  componentDidUpdate() {\r\n    // Language switch got set to open\r\n    if (this.languageSwitchDropdown && this.langSwitchOpen) {\r\n      // Force browser to redraw/refresh DOM before adding 'open' class\r\n      this.languageSwitchDropdown.getBoundingClientRect();\r\n      this.languageSwitchDropdown.classList.add('open');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Open or close the language switch programatically\r\n   * @param force Boolean to force a state\r\n   * @returns Boolean indicating new state\r\n   */\r\n  @Method()\r\n  async toggleDropdown(force?: boolean) {\r\n    this.langSwitchOpen = force ?? !this.langSwitchOpen;\r\n    this.dropdownToggled.emit({ open: this.langSwitchOpen, element: this.host });\r\n    return this.langSwitchOpen;\r\n  }\r\n\r\n  /**\r\n   * Emit a language change to the parent component\r\n   *\r\n   * @param newLang Config of the new language\r\n   */\r\n  switchLanguage(newLang: NavLangEntity) {\r\n    this.languageChanged.emit(newLang.lang);\r\n    this.toggleDropdown(false);\r\n  }\r\n\r\n  private getMergedLanguageConfig(config: NavLangEntity[], overrides?: IAvailableLanguage[]) {\r\n    if (overrides === undefined) {\r\n      return config;\r\n    }\r\n\r\n    return config.map(langConfig =>\r\n      Object.assign(\r\n        {},\r\n        langConfig,\r\n        overrides.find(l => l.lang === langConfig.lang),\r\n      ),\r\n    );\r\n  }\r\n\r\n  private setDropdownRef(element: HTMLElement | undefined) {\r\n    this.languageSwitchDropdown = element;\r\n  }\r\n\r\n  render() {\r\n    if (state.localizedConfig?.header === undefined) return;\r\n    const config = state.localizedConfig.header;\r\n    const mergedConfig = this.getMergedLanguageConfig(\r\n      config.navLang,\r\n      state.languageSwitchOverrides,\r\n    );\r\n\r\n    return (\r\n      <Host>\r\n        <div class={`language-switch ${this.mode}`}>\r\n          <SvgSprite />\r\n          {this.mode === 'dropdown' ? (\r\n            <button\r\n              class=\"lang-btn\"\r\n              aria-expanded={`${this.langSwitchOpen}`}\r\n              aria-haspopup=\"listbox\"\r\n              onClick={() => this.toggleDropdown()}\r\n            >\r\n              <span class=\"visually-hidden\">{config.translations.navLangAriaLabel}</span>\r\n              <span aria-hidden=\"true\">{state.currentLanguage}</span>\r\n              <SvgIcon name=\"pi-arrow-down\" classNames={this.langSwitchOpen ? 'rotated' : ''} />\r\n            </button>\r\n          ) : (\r\n            <span class=\"bold current-language\">\r\n              <span class=\"visually-hidden\">{translate('Current language is English')}</span>\r\n              <span>{state.currentLanguage}</span>\r\n            </span>\r\n          )}\r\n          {this.langSwitchOpen || this.mode === 'list' ? (\r\n            <PostLanguageSwitchList\r\n              navLang={mergedConfig}\r\n              switchLanguage={e => this.switchLanguage(e)}\r\n              dropdownRef={e => e !== undefined && this.setDropdownRef(e)}\r\n            />\r\n          ) : null}\r\n        </div>\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"],"version":3}